#!/bin/bash
# EndOS Debug Script Wrapper
# Downloads and runs the latest version from GitHub

SCRIPT_URL="https://raw.githubusercontent.com/USBKayble/EndOS/main/debug-script.sh"
TEMP_SCRIPT="/tmp/endos-debug-latest.sh"

echo "Downloading latest debug script..."

# Try to download the latest version
if command -v curl >/dev/null 2>&1; then
    if curl -fsSL "$SCRIPT_URL" -o "$TEMP_SCRIPT" 2>/dev/null; then
        echo "✓ Downloaded latest version"
        chmod +x "$TEMP_SCRIPT"
        exec bash "$TEMP_SCRIPT" "$@"
    else
        echo "⚠ Failed to download latest version, using built-in fallback"
    fi
elif command -v wget >/dev/null 2>&1; then
    if wget -q "$SCRIPT_URL" -O "$TEMP_SCRIPT" 2>/dev/null; then
        echo "✓ Downloaded latest version"
        chmod +x "$TEMP_SCRIPT"
        exec bash "$TEMP_SCRIPT" "$@"
    else
        echo "⚠ Failed to download latest version, using built-in fallback"
    fi
else
    echo "ERROR: No download tool available (curl/wget)"
    echo "Please install curl or wget to use the debug script"
    exit 1
fi

# If we get here, download failed
echo "ERROR: Could not download debug script from GitHub"
echo "Please check your internet connection and try again"
exit 1
