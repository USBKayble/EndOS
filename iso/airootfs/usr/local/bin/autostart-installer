#!/usr/bin/env bash
# Auto-launch EndOS Installer on first boot

# Only run if this is the live user and installer hasn't been dismissed
if [ "$USER" = "liveuser" ] && [ ! -f ~/.config/installer-dismissed ]; then
    # Wait for Hyprland and display to be ready
    sleep 5
    
    # Wait for display server
    while [ -z "$WAYLAND_DISPLAY" ] && [ -z "$DISPLAY" ]; do
        sleep 1
    done
    
    # Launch installer with logging
    echo "[$(date)] Launching EndOS installer" >> /tmp/autostart.log
    /usr/local/bin/endos-installer >> /tmp/installer.log 2>&1 &
fi
